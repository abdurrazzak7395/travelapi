
# Flyhub API Documentation

The Flyhub API provides secure access to the Flyhub platform, allowing users to perform various operations using RESTful API calls. This document outlines the authentication process and basic headers required for accessing the Flyhub API.

---

### Common Headers
These headers should be included in all API requests:

- **Content-Type**: `application/json`
- **Accept-Encoding**: `gzip, deflate`

### Root URL
All Flyhub API calls are based on the following root URL:
```
https://api.flyhub.com/api/v1/
```

## Authentication API

The **Authentication API** generates an authentication token, which is required to authorize all other API requests. This token is a bearer token valid for 7 days. Every API call (except the Authentication API itself) must include this token in the request headers.

### Endpoint
- **Method**: POST
- **URL**: `<RootUrl>/Authenticate`

### Headers
Include the following headers in the request:
```plaintext
Content-Type: application/json
Accept-Encoding: gzip, deflate
```

### Request Parameters
The Authentication API requires the following JSON parameters in the request body:

| Parameter   | Type   | Description                | Required |
|-------------|--------|----------------------------|----------|
| `username`  | String | Username provided by Flyhub | Yes      |
| `apikey`    | String | API Key provided by Flyhub  | Yes      |

### Sample Request
```json
POST https://api.flyhub.com/api/v1/Authenticate
Content-Type: application/json
Accept-Encoding: gzip, deflate

{
  "username": "your_username",
  "apikey": "your_apikey"
}
```

### Sample Response
A successful response returns a JSON object containing the user’s details and an authentication token (TokenId). This token should be stored securely and used as a bearer token in the headers of subsequent API requests.

```json
{
  "FirstName": "John",
  "LastName": "Doe",
  "Email": "your_username",
  "TokenId": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6...",
  "Status": 1,
  "Error": null
}
```

- **TokenId**: This is the bearer token. Include this token in the `Authorization` header of all subsequent API calls.
- **Status**: Indicates success (1) or failure (other codes).
- **Error**: Returns `null` if the request was successful; otherwise, provides error details.

### Using the Authentication Token

Once obtained, the `TokenId` must be included in the headers of all other API requests as follows:
```plaintext
Authorization: Bearer <TokenId>
```

### Example Usage of Token
For any subsequent API call, include the following headers:

```plaintext
Content-Type: application/json
Accept-Encoding: gzip, deflate
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWV...
```

---

## Notes

1. The authentication token (`TokenId`) is valid for **7 days**.
2. If the token expires, a new one must be generated by re-authenticating using the Authentication API.
3. For security, always keep the `TokenId` confidential and do not share it in insecure channels.

---

This concludes the authentication documentation for the Flyhub API. Ensure that each API call includes the required headers and the bearer token to maintain secure communication with the Flyhub API endpoints.

Here's a comprehensive documentation for the `GetBalance` API:

---

### GetBalance API Documentation

#### Description
The `GetBalance` API allows authorized clients to retrieve their account balance information. This includes the available balance, credit limit, and status of the request.

#### Endpoint
**URL:** `<RootUrl>/GetBalance`  
**Method:** `POST`

#### Headers
- **Authorization**: Required  
  - **Header Key**: `Authorization`
  - **Header Value**: `Bearer <Token>` (Token is received from the authentication process)

#### Request Structure

The request requires a JSON object with the following structure:

| Level | Element | Type   | Description                  | Mandatory |
|-------|---------|--------|------------------------------|-----------|
| 1     | UserName | String | The user name of the client. | Yes       |

##### Sample Request
```json
{
  "UserName": "test@sample.com"
}
```

#### Response Structure

The response contains the following fields:

| Level | Element      | Type        | Description                                             | Mandatory |
|-------|--------------|-------------|---------------------------------------------------------|-----------|
| 1     | Balance      | Decimal     | Total available balance                                 | Yes       |
| 2     | Credits      | Decimal     | Credit amount limit                                     | Yes       |
| 3     | Status       | Enumeration | Status of the response. Possible values:                | Yes       |
|       |              |             | - Not set                                               |           |
|       |              |             | - Successful                                            |           |
|       |              |             | - Failed                                                |           |
| 4     | Error        | Element     | Contains error details, if any.                         | Yes       |
| 4.1   | ErrorCode    | Enumeration | Error code indicating the type of error (if applicable) | No        |
| 4.2   | ErrorMessage | String      | Error message description (if applicable)               | No        |

##### Sample Response
For a successful request:
```json
{
  "Balance": 1200,
  "Credits": 200,
  "Status": "Successful",
  "Error": null
}
```

For a failed request (example):
```json
{
  "Balance": 0,
  "Credits": 0,
  "Status": "Failed",
  "Error": {
    "ErrorCode": "AUTH_FAILED",
    "ErrorMessage": "Authorization failed. Invalid token."
  }
}
```

#### Response Status Codes
The `Status` field in the response indicates the result of the request:
- **Not set**: The status has not been specified.
- **Successful**: The balance details were retrieved successfully.
- **Failed**: The request failed. Details are provided in the `Error` element.

#### Error Handling
In case of an error, the `Error` object will include:
- **ErrorCode**: Code specifying the error type (refer to annexure for possible codes).
- **ErrorMessage**: A human-readable description of the error.

---

**©2020-2022 Flyhub Travel Pte. Ltd.**


Here's a structured API documentation outline for BDFARE's **GetBalance** endpoint, focusing on integration details and usage for developers. This guide will help users understand the setup, testing, and live environment steps, as well as the GetBalance endpoint parameters, request structure, and responses.

---

# BDFARE Enterprise API Documentation

BDFARE provides a robust API for travel booking processes, enabling agents to access travel services seamlessly. This documentation outlines the setup, testing, and implementation of BDFARE's API, specifically focusing on the **GetBalance** endpoint.

---

## API Environments

### 1. **Sandbox Environment**
   - **Purpose**: For testing and exploring API endpoints.
   - **Base URL**: `https://bdf.centralindia.cloudapp.azure.com/api/enterprise`
   - **Swagger Documentation**: [Sandbox Swagger](https://bdf.centralindia.cloudapp.azure.com/bdfare-enterprise-api/swagger/index.html)
   - **Usage**: Use the sandbox environment for development and testing. Swagger provides JSON samples, parameter descriptions, and testing capabilities.

### 2. **Live Environment**
   - **Purpose**: For production use after certification.
   - **Base URL**: `https://bdfare.com/api/enterprise`
   - **Swagger Documentation**: [Live Swagger](https://bdfare.com/bdfare-enterprise-api/swagger/index.html)
   - **Usage**: After successful testing and certification in the sandbox environment, you can proceed to the live environment.

---

## API Integration Flow

1. **Setup Sandbox Environment**: Access the sandbox environment to test the API functionality.
2. **Endpoint Testing**: Use the sandbox Swagger documentation for sample requests and responses.
3. **Certification for Live Environment**: Complete sandbox testing, then request test cases from BDFARE for certification.
4. **Transition to Live**: After certification, transition to the live environment for production use.

---

## Endpoint Details: GetBalance

### **Endpoint**: `/GetBalance`

**Description**: Retrieves the account balance associated with your BDFARE account.

- **Sandbox Base URL**: `https://bdf.centralindia.cloudapp.azure.com/api/enterprise/GetBalance`
- **Live Base URL**: `https://bdfare.com/api/enterprise/GetBalance`

### **Request Details**

- **Method**: `POST`
- **Content-Type**: `application/json`
- **Headers**:
  - `Authorization`: Bearer token obtained via the authentication endpoint
  - `Content-Type`: `application/json`

#### **Request Body Parameters**

| Parameter   | Type   | Description                |
|-------------|--------|----------------------------|
| `UserName`  | String | Your BDFARE username.      |

**Example Request Body**:
```json
{
  "UserName": "your_bdfare_username"
}
```

### **Response Details**

The `GetBalance` endpoint returns a JSON response containing your account balance details.

#### **Successful Response (Status Code: 200)**

| Field       | Type   | Description                             |
|-------------|--------|-----------------------------------------|
| `balance`   | String | Current balance available in the account. |
| `currency`  | String | Currency of the balance (e.g., BDT).       |
| `status`    | String | Status message indicating success.         |

**Example Response**:
```json
{
  "balance": "5000.00",
  "currency": "BDT",
  "status": "success"
}
```

#### **Error Responses**

| Status Code | Message                    | Description                                  |
|-------------|----------------------------|----------------------------------------------|
| 400         | `Invalid request`          | The request body is malformed.               |
| 401         | `Unauthorized`             | Authentication token is missing or invalid.  |
| 500         | `Internal server error`    | Server encountered an unexpected condition.  |

**Example Error Response**:
```json
{
  "status": "error",
  "message": "Unauthorized access. Token invalid."
}
```

---

### **Example Code Snippet for Authentication and GetBalance**

Here's a sample code snippet in Python to authenticate and call the `GetBalance` endpoint:

```python
import requests
import os

class BDFAREClient:
    def __init__(self):
        self.base_url = "https://bdf.centralindia.cloudapp.azure.com/api/enterprise"  # Use sandbox for testing
        self.username = os.getenv("BDFARE_USERNAME")
        self.apikey = os.getenv("BDFARE_APIKEY")
        self.token = self.authenticate()

    def authenticate(self):
        url = f"{self.base_url}/Authenticate"
        headers = {"Content-Type": "application/json"}
        data = {"apikey": self.apikey}
        
        response = requests.post(url, headers=headers, json=data)
        response.raise_for_status()  # Raises an error for HTTP errors
        self.token = response.json().get("TokenId")
        if not self.token:
            raise ValueError("Authentication failed: Token not found.")
        return self.token

    def get_balance(self):
        url = f"{self.base_url}/GetBalance"
        headers = {
            "Authorization": f"Bearer {self.token}",
            "Content-Type": "application/json"
        }
        data = {"UserName": self.username}
        
        response = requests.post(url, headers=headers, json=data)
        response.raise_for_status()  # Raises an error for HTTP errors
        return response.json()

# Example usage
client = BDFAREClient()
balance_info = client.get_balance()
print(balance_info)
```

### Notes:
- **Environment Variables**: Set `BDFARE_USERNAME` and `BDFARE_APIKEY` in your environment for security.
- **Exception Handling**: Use `response.raise_for_status()` to catch HTTP errors gracefully.

--- 

This documentation provides essential details to integrate the **GetBalance** endpoint of BDFARE's API, from setting up a testing environment to making authenticated requests in production. For additional support, refer to BDFARE's [Swagger documentation](https://bdf.centralindia.cloudapp.azure.com/bdfare-enterprise-api/swagger/index.html) for further details on parameters and response fields.